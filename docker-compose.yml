  services:
    postgres:
      image: pgvector/pgvector:pg17
      container_name: pgvector-db
      restart: unless-stopped
      environment:
        POSTGRES_USER: postgres
        POSTGRES_PASSWORD: postgres
        POSTGRES_DB: vector_db
      ports:
        - "5432:5432"
      volumes:
        - pgdata:/var/lib/postgresql/data
        - ./postgres/schema.sql:/docker-entrypoint-initdb.d/schema.sql:ro
      healthcheck:
        test: ["CMD-SHELL", "pg_isready -U postgres -d vector_db -h localhost"]
        interval: 10s
        timeout: 5s
        retries: 5
      stop_grace_period: 1m
  
  volumes:
    pgdata:
      driver: local
    

   